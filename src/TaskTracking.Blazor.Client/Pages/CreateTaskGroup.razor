@page "/task-groups/create"
@using TaskTracking.TaskGroupAggregate.Dtos.TaskGroups
@inherits TaskTrackingComponentBase

<div class="islamic-pattern-bg">
    <MudContainer MaxWidth="MaxWidth.Large" Class="py-4">
        <!-- Header Section -->
        <div class="d-flex align-items-center mb-4">
            <MudIconButton Icon="@Icons.Material.Filled.ArrowBack"
                           Color="Color.Primary"
                           OnClick="@(() => NavigationManager.NavigateTo("/"))"
                           Class="me-3" />
            <div>
                <MudText Typo="Typo.h4" Class="section-title mb-1">
                    <MudIcon Icon="@Icons.Material.Filled.Add" Class="me-2" />
                    @L["CreateTaskGroup"]
                </MudText>
                <MudText Typo="Typo.body2" Class="text-muted">
                    @L["CreateNewTaskGroupDetails"]
                </MudText>
            </div>
        </div>

        <!-- Create Form -->
        <MudCard Class="islamic-card" Elevation="3">
            <MudCardContent Class="pa-6">
                <EditForm Model="@CreateDto" OnValidSubmit="@HandleValidSubmit">
                    <DataAnnotationsValidator />
                    
                    <!-- Title Field -->
                    <MudTextField @bind-Value="CreateDto.Title"
                                  Label="@L["Title"]"
                                  Variant="Variant.Outlined"
                                  Class="mb-4"
                                  Required="true"
                                  MaxLength="200"
                                  Counter="200"
                                  HelperText="@L["EnterTaskGroupTitle"]"
                                  For="@(() => CreateDto.Title)" />

                    <!-- Description Field -->
                    <MudGrid Class="mb-4" Spacing="10">
                        <MudItem xs="12" md="6">
                            <MudTextField @bind-Value="CreateDto.Description"
                                          Label="@L["Description"]"
                                          Variant="Variant.Outlined"
                                          Lines="8"
                                          Class="mb-4"
                                          Required="true"
                                          MaxLength="4000"
                                          Counter="4000"
                                          HelperText="@L["EnterTaskGroupDescription"]"
                                          Immediate="true"
                                          For="@(() => CreateDto.Description)"/>
                        </MudItem>

                        <MudItem xs="12" md="6" Style="margin-top: 20px">
                            <MudMarkdown Value="@CreateDto.Description"/>
                        </MudItem>
                    </MudGrid>

                    <!-- Date Fields -->
                    <MudGrid Class="mb-4">
                        <MudItem xs="12" md="6">
                            <MudDatePicker @bind-Date="StartDatePicker"
                                           Label="@L["StartDate"]"
                                           Variant="Variant.Outlined"
                                           Required="true"
                                           DateFormat="dd/MM/yyyy"
                                           HelperText="@L["SelectStartDate"]" />
                        </MudItem>
                        <MudItem xs="12" md="6">
                            <MudDatePicker @bind-Date="EndDatePicker"
                                           Label="@L["EndDate"]"
                                           Variant="Variant.Outlined"
                                           DateFormat="dd/MM/yyyy"
                                           Clearable="true"
                                           HelperText="@L["OptionalEndDate"]" />
                        </MudItem>
                    </MudGrid>

                    <!-- Information Card -->
                    <MudAlert Severity="Severity.Info" Class="mb-4">
                        <MudText Typo="Typo.body2">
                            <MudIcon Icon="@Icons.Material.Filled.Info" Size="Size.Small" Class="me-2" />
                            @L["CreateTaskGroupInfo"]
                        </MudText>
                    </MudAlert>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-between align-items-center">
                        <MudButton Variant="Variant.Text"
                                   Color="Color.Default"
                                   StartIcon="@Icons.Material.Filled.Cancel"
                                   OnClick="@(() => NavigationManager.NavigateTo("/"))">
                            @L["Cancel"]
                        </MudButton>

                        <MudButton ButtonType="ButtonType.Submit"
                                   Variant="Variant.Filled"
                                   Color="Color.Primary"
                                   StartIcon="@Icons.Material.Filled.Save"
                                   Disabled="@IsSubmitting">
                            @if (IsSubmitting)
                            {
                                <MudProgressCircular Size="Size.Small" Indeterminate="true" Class="me-2" />
                            }
                            @L["CreateTaskGroup"]
                        </MudButton>
                    </div>
                </EditForm>
            </MudCardContent>
        </MudCard>

        <!-- Quick Start Tips -->
        <MudCard Class="mt-4" Elevation="2">
            <MudCardContent Class="pa-4">
                <MudText Typo="Typo.h6" Class="mb-3">
                    <MudIcon Icon="@Icons.Material.Filled.Lightbulb" Class="me-2" Color="Color.Warning" />
                    @L["QuickStartTips"]
                </MudText>
                <MudList T="string" Dense="true">
                    <MudListItem T="string" Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                        <MudText Typo="Typo.body2">@L["TipChooseDescriptiveTitle"]</MudText>
                    </MudListItem>
                    <MudListItem T="string" Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                        <MudText Typo="Typo.body2">@L["TipAddDetailedDescription"]</MudText>
                    </MudListItem>
                    <MudListItem T="string" Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                        <MudText Typo="Typo.body2">@L["TipSetRealisticDates"]</MudText>
                    </MudListItem>
                    <MudListItem T="string" Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                        <MudText Typo="Typo.body2">@L["TipEndDateOptional"]</MudText>
                    </MudListItem>
                </MudList>
            </MudCardContent>
        </MudCard>
    </MudContainer>
</div>